# =========================
# App basics
# =========================
# Application name (appears in logs/metrics)
spring.application.name=gorogoro
# Embedded Tomcat port
server.port=9000
# Root logger level
logging.level.root=info

# =========================
# Database (MySQL / HikariCP)
# =========================
# JDBC URL, fixed to Asia/Tokyo (+09:00)
spring.datasource.url=jdbc:mysql://localhost:3306/gorogoro_db?useSSL=false&serverTimezone=Asia/Tokyo&allowPublicKeyRetrieval=true
# Dev DB user (use secrets in prod)
spring.datasource.username=root
# Dev DB password (use secrets in prod)
spring.datasource.password=rootroot

# Do NOT let Hibernate change schema (Flyway owns DDL)
spring.jpa.hibernate.ddl-auto=none
# Pretty-print SQL in logs (dev only)
spring.jpa.properties.hibernate.format_sql=true
# Log executed SQL (dev only)
spring.jpa.show-sql=true
# Hibernate dialect (Hibernate 6+ recommends this)
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQLDialect
# Disable Open Session in View
spring.jpa.open-in-view=false

# HikariCP pool tuning
# ms to wait for a connection from pool
spring.datasource.hikari.connection-timeout=20000
# Min idle connections to keep warm
spring.datasource.hikari.minimum-idle=10
# Max concurrent connections in pool
spring.datasource.hikari.maximum-pool-size=10
# ms before an idle connection is retired
spring.datasource.hikari.idle-timeout=300000
# ms max lifetime of a connection
spring.datasource.hikari.max-lifetime=1800000

# =========================
# Flyway (DB migrations)
# =========================
# Run migrations on app startup
spring.flyway.enabled=true
# SQL location
spring.flyway.locations=classpath:db/migration
# Verify checksums to prevent drift
spring.flyway.validate-on-migrate=true
# Safety: disallow 'clean'
spring.flyway.clean-disabled=true
# Enforce strictly increasing versions
spring.flyway.out-of-order=false
# Retry DB connection during startup
spring.flyway.connect-retries=3
# Set to true only once when adopting Flyway on existing DB
spring.flyway.baseline-on-migrate=false

# =========================
# View / Multipart uploads
# =========================
# Disable template cache in dev
spring.thymeleaf.cache=false
# Enable multipart upload
spring.servlet.multipart.enabled=true
# Max size per file
spring.servlet.multipart.max-file-size=100MB
# Max total request size
spring.servlet.multipart.max-request-size=200MB

# =========================
# Local file storage (dev)
# =========================
# Base folder under project working dir
upload.base-dir=${user.dir}/files
# Space cover/detail images
upload.space-photo=${upload.base-dir}/space-photo
# Review images
upload.review-photo=${upload.base-dir}/review-photo
